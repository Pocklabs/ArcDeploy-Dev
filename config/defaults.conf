# ArcDeploy System Defaults Configuration
# This file contains system-wide defaults that apply to all profiles
# These values are loaded first and can be overridden by profile-specific settings

# ============================================================================
# System Metadata
# ============================================================================
CONFIG_VERSION="1.0.0"
CONFIG_SCHEMA_VERSION="1.0"
LAST_UPDATED="2024-01-15"
MAINTAINER="ArcDeploy Team"

# ============================================================================
# Core System Requirements
# ============================================================================

# Operating system requirements
SUPPORTED_OS="ubuntu"
MIN_OS_VERSION="20.04"
RECOMMENDED_OS_VERSION="22.04"
SUPPORTED_ARCHITECTURES="x86_64,amd64"

# Hardware requirements (minimum)
MIN_CPU_CORES="2"
MIN_MEMORY_MB="2048"
MIN_DISK_GB="20"
MIN_NETWORK_MBPS="10"

# Hardware requirements (recommended)
RECOMMENDED_CPU_CORES="4"
RECOMMENDED_MEMORY_MB="4096"
RECOMMENDED_DISK_GB="50"
RECOMMENDED_NETWORK_MBPS="100"

# ============================================================================
# Default User Configuration
# ============================================================================

# Default user settings
DEFAULT_USER_NAME="arcblock"
DEFAULT_USER_GROUP="arcblock"
DEFAULT_USER_SHELL="/bin/bash"
DEFAULT_USER_HOME_BASE="/home"

# User permissions
DEFAULT_SUDO_ACCESS="true"
DEFAULT_PASSWORD_AUTH="false"
DEFAULT_USER_GROUPS="sudo"

# ============================================================================
# Default Network Configuration
# ============================================================================

# Default ports (non-privileged range)
DEFAULT_SSH_PORT="2222"
DEFAULT_HTTP_PORT="8080"
DEFAULT_HTTPS_PORT="8443"
DEFAULT_ADMIN_PORT="8081"

# Port ranges
MIN_PORT="1024"
MAX_PORT="65535"
PRIVILEGED_PORT_THRESHOLD="1024"

# Network defaults
DEFAULT_INTERFACE="eth0"
DEFAULT_IP_VERSION="4"
ENABLE_IPV6_DEFAULT="false"

# ============================================================================
# Default Security Settings
# ============================================================================

# SSH security defaults
SSH_PROTOCOL_DEFAULT="2"
SSH_MAX_AUTH_TRIES_DEFAULT="3"
SSH_LOGIN_GRACE_TIME_DEFAULT="60"
SSH_PERMIT_ROOT_LOGIN_DEFAULT="no"
SSH_PASSWORD_AUTH_DEFAULT="no"
SSH_PUBKEY_AUTH_DEFAULT="yes"
SSH_X11_FORWARDING_DEFAULT="no"

# Firewall defaults
FIREWALL_ENABLED_DEFAULT="true"
FIREWALL_DEFAULT_POLICY="deny"
FIREWALL_LOGGING_DEFAULT="on"

# Fail2ban defaults
FAIL2BAN_ENABLED_DEFAULT="true"
FAIL2BAN_BANTIME_DEFAULT="3600"
FAIL2BAN_FINDTIME_DEFAULT="600"
FAIL2BAN_MAXRETRY_DEFAULT="3"

# SSL/TLS defaults
SSL_ENABLED_DEFAULT="false"
SSL_PROTOCOL_DEFAULT="TLSv1.2 TLSv1.3"
SSL_CERTIFICATE_TYPE_DEFAULT="self-signed"

# ============================================================================
# Default Installation Paths
# ============================================================================

# Application directories
DEFAULT_APP_DIR="/opt"
DEFAULT_BLOCKLET_DIR="/opt/blocklet-server"
DEFAULT_NODE_DIR="/opt/node"
DEFAULT_NGINX_DIR="/etc/nginx"

# Configuration directories
DEFAULT_CONFIG_DIR="/etc/arcdeploy"
DEFAULT_SYSTEM_CONFIG_DIR="/etc"

# Data directories
DEFAULT_DATA_DIR="/var/lib/arcdeploy"
DEFAULT_LOG_DIR="/var/log/arcdeploy"
DEFAULT_CACHE_DIR="/var/cache/arcdeploy"
DEFAULT_TMP_DIR="/tmp/arcdeploy"

# Backup directories
DEFAULT_BACKUP_DIR="/var/backups/arcdeploy"
DEFAULT_BACKUP_RETENTION_DAYS="7"

# ============================================================================
# Default Service Configuration
# ============================================================================

# Service management
DEFAULT_SERVICE_MANAGER="systemd"
DEFAULT_SERVICE_USER="arcblock"
DEFAULT_SERVICE_GROUP="arcblock"

# Service behavior
DEFAULT_AUTO_START="true"
DEFAULT_AUTO_RESTART="true"
DEFAULT_RESTART_DELAY="5"
DEFAULT_MAX_RESTART_ATTEMPTS="3"

# Service timeouts
DEFAULT_START_TIMEOUT="300"
DEFAULT_STOP_TIMEOUT="60"
DEFAULT_RELOAD_TIMEOUT="30"

# ============================================================================
# Default Package Management
# ============================================================================

# Package manager
DEFAULT_PACKAGE_MANAGER="apt"
DEFAULT_PACKAGE_UPDATE="true"
DEFAULT_PACKAGE_UPGRADE="false"

# Package sources
DEFAULT_NODEJS_VERSION="18"
DEFAULT_NGINX_VERSION="latest"
DEFAULT_PYTHON_VERSION="3"

# Package installation behavior
AUTO_CONFIRM_PACKAGES="true"
INSTALL_RECOMMENDED="false"
INSTALL_SUGGESTS="false"

# ============================================================================
# Default Performance Settings
# ============================================================================

# Node.js defaults
DEFAULT_NODE_MAX_MEMORY="2048"
DEFAULT_NODE_MAX_OLD_SPACE_SIZE="1536"
DEFAULT_NODE_WORKER_PROCESSES="auto"

# Nginx defaults
DEFAULT_NGINX_WORKER_PROCESSES="auto"
DEFAULT_NGINX_WORKER_CONNECTIONS="1024"
DEFAULT_NGINX_KEEPALIVE_TIMEOUT="65"

# System performance
DEFAULT_SWAPPINESS="10"
DEFAULT_VM_DIRTY_RATIO="15"
DEFAULT_FILE_MAX="65536"

# ============================================================================
# Default Logging Configuration
# ============================================================================

# Log levels
DEFAULT_LOG_LEVEL="info"
AVAILABLE_LOG_LEVELS="debug,info,warning,error,critical"

# Log formatting
DEFAULT_LOG_FORMAT="standard"
DEFAULT_TIMESTAMP_FORMAT="%Y-%m-%d %H:%M:%S"
DEFAULT_LOG_ENCODING="utf-8"

# Log rotation
DEFAULT_LOG_MAX_SIZE="100M"
DEFAULT_LOG_RETENTION_DAYS="7"
DEFAULT_LOG_COMPRESS="true"
DEFAULT_LOG_ROTATION="daily"

# Log destinations
DEFAULT_LOG_TO_FILE="true"
DEFAULT_LOG_TO_SYSLOG="false"
DEFAULT_LOG_TO_STDOUT="true"

# ============================================================================
# Default Monitoring Settings
# ============================================================================

# Health checks
DEFAULT_HEALTH_CHECK_ENABLED="true"
DEFAULT_HEALTH_CHECK_INTERVAL="300"
DEFAULT_HEALTH_CHECK_TIMEOUT="30"
DEFAULT_HEALTH_CHECK_RETRIES="3"

# System monitoring
DEFAULT_MONITOR_CPU="true"
DEFAULT_MONITOR_MEMORY="true"
DEFAULT_MONITOR_DISK="true"
DEFAULT_MONITOR_NETWORK="true"

# Thresholds
DEFAULT_CPU_THRESHOLD="90"
DEFAULT_MEMORY_THRESHOLD="90"
DEFAULT_DISK_THRESHOLD="90"
DEFAULT_LOAD_THRESHOLD="5.0"

# ============================================================================
# Default Feature Flags
# ============================================================================

# Core features (always enabled by default)
DEFAULT_SSH_HARDENING="true"
DEFAULT_FIREWALL_ENABLED="true"
DEFAULT_FAIL2BAN_ENABLED="true"
DEFAULT_AUTO_UPDATES="true"
DEFAULT_HEALTH_MONITORING="true"

# Optional features (disabled by default)
DEFAULT_SSL_ENABLED="false"
DEFAULT_MULTI_CLOUD="false"
DEFAULT_ADVANCED_LOGGING="false"
DEFAULT_PERFORMANCE_MONITORING="false"
DEFAULT_DEBUG_MODE="false"

# Experimental features (disabled by default)
DEFAULT_EXPERIMENTAL_FEATURES="false"
DEFAULT_BETA_FEATURES="false"

# ============================================================================
# Default Cloud Provider Settings
# ============================================================================

# Provider defaults
DEFAULT_CLOUD_PROVIDER="hetzner"
SUPPORTED_CLOUD_PROVIDERS="hetzner,aws,gcp,azure,digitalocean,linode,vultr"

# Instance defaults
DEFAULT_INSTANCE_TYPE=""
DEFAULT_REGION=""
DEFAULT_AVAILABILITY_ZONE=""

# Cloud-specific features
DEFAULT_CLOUD_INIT_VERSION="22.1"
DEFAULT_CLOUD_METADATA_ENABLED="true"
DEFAULT_CLOUD_MONITORING_ENABLED="false"

# ============================================================================
# Default Backup Configuration
# ============================================================================

# Backup defaults
DEFAULT_BACKUP_ENABLED="false"
DEFAULT_BACKUP_TYPE="incremental"
DEFAULT_BACKUP_FREQUENCY="daily"
DEFAULT_BACKUP_TIME="02:00"

# Backup retention
DEFAULT_BACKUP_RETENTION_DAYS="7"
DEFAULT_BACKUP_MAX_COUNT="30"
DEFAULT_BACKUP_COMPRESSION="gzip"

# Backup validation
DEFAULT_BACKUP_VERIFICATION="true"
DEFAULT_BACKUP_ENCRYPTION="false"

# ============================================================================
# Default Error Handling
# ============================================================================

# Error behavior
DEFAULT_FAIL_ON_ERROR="true"
DEFAULT_CONTINUE_ON_WARNING="true"
DEFAULT_AUTO_RETRY="true"
DEFAULT_MAX_RETRIES="3"
DEFAULT_RETRY_DELAY="5"

# Recovery behavior
DEFAULT_AUTO_RECOVERY="true"
DEFAULT_ROLLBACK_ON_FAILURE="false"
DEFAULT_RECOVERY_TIMEOUT="300"

# Error reporting
DEFAULT_ERROR_LOGGING="true"
DEFAULT_ERROR_NOTIFICATION="false"
DEFAULT_VERBOSE_ERRORS="false"

# ============================================================================
# Default Update Configuration
# ============================================================================

# Update behavior
DEFAULT_AUTO_UPDATE_SECURITY="true"
DEFAULT_AUTO_UPDATE_ALL="false"
DEFAULT_UPDATE_CHECK_INTERVAL="daily"
DEFAULT_REBOOT_REQUIRED="false"

# Update timing
DEFAULT_UPDATE_TIME="03:00"
DEFAULT_UPDATE_WINDOW="2h"
DEFAULT_UPDATE_RETRY_COUNT="3"

# Update notification
DEFAULT_UPDATE_NOTIFICATION="false"
DEFAULT_UPDATE_LOG="true"

# ============================================================================
# Default Development Settings
# ============================================================================

# Development features (disabled by default)
DEFAULT_DEVELOPMENT_MODE="false"
DEFAULT_DEBUG_ENDPOINTS="false"
DEFAULT_HOT_RELOAD="false"
DEFAULT_SOURCE_MAPS="false"

# Testing defaults
DEFAULT_TESTING_ENABLED="false"
DEFAULT_TEST_COVERAGE="false"
DEFAULT_TEST_REPORTS="false"

# ============================================================================
# Default Validation Rules
# ============================================================================

# Required system commands
REQUIRED_COMMANDS="bash,curl,wget,systemctl,ufw,ssh,scp"

# Required system packages
REQUIRED_PACKAGES="curl,wget,gnupg,software-properties-common"

# Validation behavior
DEFAULT_VALIDATE_SYSTEM="true"
DEFAULT_VALIDATE_NETWORK="true"
DEFAULT_VALIDATE_DEPENDENCIES="true"
DEFAULT_VALIDATE_PERMISSIONS="true"

# Validation timeouts
DEFAULT_VALIDATION_TIMEOUT="60"
DEFAULT_NETWORK_TEST_TIMEOUT="30"
DEFAULT_DEPENDENCY_CHECK_TIMEOUT="120"

# ============================================================================
# Default Output Settings
# ============================================================================

# Output formatting
DEFAULT_OUTPUT_FORMAT="simple"
DEFAULT_COLOR_OUTPUT="true"
DEFAULT_PROGRESS_INDICATORS="true"
DEFAULT_VERBOSE_OUTPUT="false"

# Interactive behavior
DEFAULT_INTERACTIVE_MODE="false"
DEFAULT_CONFIRMATION_PROMPTS="true"
DEFAULT_AUTO_CONFIRM="false"

# Status reporting
DEFAULT_SHOW_TIMESTAMPS="false"
DEFAULT_SHOW_PROGRESS="true"
DEFAULT_SHOW_STATISTICS="false"

# ============================================================================
# System Constants
# ============================================================================

# Version information
ARCDEPLOY_VERSION="2.0.0"
CONFIG_FORMAT_VERSION="1.0"
MINIMUM_BASH_VERSION="4.0"

# File extensions
CONFIG_FILE_EXTENSION=".conf"
SCRIPT_FILE_EXTENSION=".sh"
TEMPLATE_FILE_EXTENSION=".template"
BACKUP_FILE_EXTENSION=".backup"

# Character limits
MAX_USERNAME_LENGTH="32"
MAX_HOSTNAME_LENGTH="63"
MAX_DOMAIN_LENGTH="253"
MAX_PATH_LENGTH="4096"

# Timeouts (seconds)
DEFAULT_COMMAND_TIMEOUT="300"
DEFAULT_NETWORK_TIMEOUT="30"
DEFAULT_SERVICE_TIMEOUT="60"
DEFAULT_DOWNLOAD_TIMEOUT="300"

# ============================================================================
# Environment Variables
# ============================================================================

# System environment defaults
DEFAULT_LANG="en_US.UTF-8"
DEFAULT_LC_ALL="en_US.UTF-8"
DEFAULT_TIMEZONE="UTC"
DEFAULT_PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"

# Application environment
DEFAULT_NODE_ENV="production"
DEFAULT_NPM_CONFIG_LOGLEVEL="warn"
DEFAULT_NPM_CONFIG_PROGRESS="false"

# ============================================================================
# Compatibility Settings
# ============================================================================

# Backward compatibility
MAINTAIN_LEGACY_PATHS="true"
SUPPORT_DEPRECATED_OPTIONS="true"
LEGACY_WARNING_LEVEL="warning"

# Version compatibility
MIN_SUPPORTED_VERSION="1.0.0"
DEPRECATION_WARNING_VERSION="2.0.0"
REMOVAL_VERSION="3.0.0"

# Migration settings
AUTO_MIGRATE_CONFIG="true"
BACKUP_BEFORE_MIGRATION="true"
MIGRATION_LOG_LEVEL="info"

# ============================================================================
# Default File Permissions
# ============================================================================

# Configuration files
CONFIG_FILE_PERMISSIONS="644"
SECRET_FILE_PERMISSIONS="600"
SCRIPT_FILE_PERMISSIONS="755"
LOG_FILE_PERMISSIONS="644"

# Directories
CONFIG_DIR_PERMISSIONS="755"
DATA_DIR_PERMISSIONS="755"
LOG_DIR_PERMISSIONS="755"
BACKUP_DIR_PERMISSIONS="700"

# Special files
SSH_KEY_PERMISSIONS="600"
SSL_CERT_PERMISSIONS="644"
SSL_KEY_PERMISSIONS="600"

# ============================================================================
# Notes
# ============================================================================

# These defaults are designed to:
# 1. Provide secure, conservative settings out of the box
# 2. Work on most standard Ubuntu installations
# 3. Be easily overrideable by profile-specific configurations
# 4. Maintain backward compatibility with existing deployments
# 5. Follow security best practices
#
# To override any default:
# 1. Set the value in your profile configuration (simple.conf or advanced.conf)
# 2. Set the value in the main arcdeploy.conf file
# 3. Export the value as an environment variable
#
# Loading order (later values override earlier ones):
# 1. defaults.conf (this file)
# 2. profile configuration (simple.conf or advanced.conf)
# 3. arcdeploy.conf (user customizations)
# 4. environment variables