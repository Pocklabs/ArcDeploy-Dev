# ArcDeploy Advanced Profile Configuration
# This profile provides comprehensive features for power users and enterprise deployments
# Suitable for: Multi-cloud deployments, enterprise setups, development environments

# ============================================================================
# Profile Metadata
# ============================================================================
PROFILE_NAME="advanced"
PROFILE_VERSION="1.0.0"
PROFILE_DESCRIPTION="Advanced deployment profile with full feature set"
PROFILE_TARGET_BRANCH="dev-deployment"

# ============================================================================
# Core Settings (Enhanced)
# ============================================================================

# User account settings
USER_NAME="arcblock"
USER_GROUP="arcblock"
USER_HOME="/home/arcblock"
USER_SHELL="/bin/bash"
USER_GROUPS="sudo,docker,adm"

# Network configuration
SSH_PORT="2222"
BLOCKLET_HTTP_PORT="8080"
BLOCKLET_HTTPS_PORT="8443"
NGINX_HTTP_PORT="80"
NGINX_HTTPS_PORT="443"
MONITORING_PORT="9090"
METRICS_PORT="9100"

# Installation paths
BLOCKLET_BASE_DIR="/opt/blocklet-server"
NODE_HOME="/opt/node"
CONFIG_DIR="/etc/arcdeploy"
LOGS_DIR="/var/log/arcdeploy"
CACHE_DIR="/var/cache/arcdeploy"
TMP_DIR="/tmp/arcdeploy"

# ============================================================================
# Feature Flags (Advanced Profile)
# ============================================================================

# Core features (always enabled)
ENABLE_SSH_HARDENING="true"
ENABLE_BASIC_FIREWALL="true"
ENABLE_FAIL2BAN="true"
ENABLE_AUTO_UPDATES="true"

# Advanced features (enabled for full functionality)
ENABLE_MULTI_CLOUD="true"
ENABLE_ADVANCED_TESTING="true"
ENABLE_PERFORMANCE_MONITORING="true"
ENABLE_CUSTOM_TEMPLATES="true"
ENABLE_ADVANCED_LOGGING="true"
ENABLE_DEBUG_MODE="true"
ENABLE_METRICS_COLLECTION="true"
ENABLE_DISTRIBUTED_DEPLOYMENT="true"

# Optional features (configurable)
ENABLE_SSL="false"
ENABLE_NGINX_PROXY="true"
ENABLE_HEALTH_CHECKS="true"
ENABLE_LOAD_BALANCING="false"
ENABLE_CDN="false"
ENABLE_BACKUP_ENCRYPTION="true"

# Experimental features (use with caution)
ENABLE_EXPERIMENTAL_FEATURES="false"
ENABLE_BETA_CLOUD_PROVIDERS="false"
ENABLE_AI_OPTIMIZATION="false"

# ============================================================================
# Multi-Cloud Configuration
# ============================================================================

# Supported cloud providers
SUPPORTED_PROVIDERS="hetzner,aws,gcp,azure,digitalocean,linode,vultr"
DEFAULT_CLOUD_PROVIDER="hetzner"

# Provider-specific features
ENABLE_AWS_SPECIFIC="true"
ENABLE_GCP_SPECIFIC="true"
ENABLE_AZURE_SPECIFIC="true"
ENABLE_DO_SPECIFIC="true"
ENABLE_HETZNER_SPECIFIC="true"
ENABLE_LINODE_SPECIFIC="true"
ENABLE_VULTR_SPECIFIC="true"

# Cloud provider integrations
ENABLE_CLOUD_INIT_V2="true"
ENABLE_CLOUD_METADATA="true"
ENABLE_CLOUD_STORAGE="true"
ENABLE_CLOUD_MONITORING="true"
ENABLE_CLOUD_NETWORKING="true"

# ============================================================================
# Security Settings (Enterprise Grade)
# ============================================================================

# SSH security (comprehensive)
ENABLE_PASSWORD_AUTH="false"
SSH_MAX_AUTH_TRIES="3"
SSH_LOGIN_GRACE_TIME="60"
SSH_PERMIT_ROOT_LOGIN="no"
SSH_PROTOCOL="2"
SSH_CIPHERS="chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr"
SSH_MACS="hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha2-256,hmac-sha2-512"
SSH_KEXALGORITHMS="curve25519-sha256@libssh.org,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512"

# Advanced firewall configuration
UFW_DEFAULT_POLICY="deny"
UFW_LOGGING="full"
ENABLE_IPTABLES_RULES="true"
ENABLE_IP6TABLES_RULES="true"
ENABLE_RATE_LIMITING="true"
ENABLE_DDoS_PROTECTION="true"
ENABLE_GEO_BLOCKING="false"

# Fail2ban (advanced configuration)
FAIL2BAN_BANTIME="7200"
FAIL2BAN_FINDTIME="600"
FAIL2BAN_MAXRETRY="3"
FAIL2BAN_BACKEND="systemd"
FAIL2BAN_DESTEMAIL=""
ENABLE_FAIL2BAN_EMAIL="false"

# SSL/TLS configuration
SSL_PROTOCOL="TLSv1.2 TLSv1.3"
SSL_CIPHERS="ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384"
SSL_PREFER_SERVER_CIPHERS="off"
ENABLE_HSTS="true"
HSTS_MAX_AGE="31536000"
ENABLE_OCSP_STAPLING="true"

# Security headers
ENABLE_SECURITY_HEADERS="true"
ENABLE_CSP="true"
ENABLE_X_FRAME_OPTIONS="true"
ENABLE_X_CONTENT_TYPE_OPTIONS="true"
ENABLE_REFERRER_POLICY="true"

# ============================================================================
# Performance Settings (Optimized)
# ============================================================================

# Resource limits (optimized for performance)
NODE_MAX_MEMORY="4096"
NODE_MAX_OLD_SPACE_SIZE="3072"
BLOCKLET_WORKER_PROCESSES="auto"
NGINX_WORKER_PROCESSES="auto"
NGINX_WORKER_CONNECTIONS="1024"

# Caching configuration
ENABLE_REDIS_CACHE="false"
ENABLE_MEMORY_CACHE="true"
ENABLE_FILE_CACHE="true"
CACHE_TTL="3600"
CACHE_MAX_SIZE="256M"

# Database optimization
ENABLE_DB_OPTIMIZATION="true"
DB_MAX_CONNECTIONS="100"
DB_QUERY_CACHE_SIZE="64M"
DB_INNODB_BUFFER_POOL_SIZE="256M"

# Network optimization
TCP_FASTOPEN="true"
TCP_BBR="true"
NGINX_SENDFILE="on"
NGINX_TCP_NOPUSH="on"
NGINX_TCP_NODELAY="on"
NGINX_KEEPALIVE_TIMEOUT="65"

# Compression
ENABLE_GZIP="true"
ENABLE_BROTLI="true"
GZIP_COMP_LEVEL="6"
GZIP_MIN_LENGTH="1024"

# ============================================================================
# Monitoring & Observability
# ============================================================================

# System monitoring
ENABLE_SYSTEM_MONITORING="true"
ENABLE_SERVICE_MONITORING="true"
ENABLE_PERFORMANCE_MONITORING="true"
ENABLE_CUSTOM_METRICS="true"
ENABLE_DISTRIBUTED_TRACING="false"

# Monitoring tools
ENABLE_PROMETHEUS="false"
ENABLE_GRAFANA="false"
ENABLE_ALERTMANAGER="false"
ENABLE_NODE_EXPORTER="true"
ENABLE_NGINX_EXPORTER="false"

# Health checks
HEALTH_CHECK_INTERVAL="60"
SERVICE_CHECK_INTERVAL="30"
DISK_CHECK_THRESHOLD="85"
MEMORY_CHECK_THRESHOLD="85"
CPU_CHECK_THRESHOLD="90"
LOAD_CHECK_THRESHOLD="5.0"

# Alerting
ENABLE_EMAIL_ALERTS="false"
ENABLE_SLACK_ALERTS="false"
ENABLE_WEBHOOK_ALERTS="false"
ALERT_EMAIL=""
ALERT_SLACK_WEBHOOK=""
ALERT_WEBHOOK_URL=""

# ============================================================================
# Logging Configuration (Comprehensive)
# ============================================================================

# Log levels and types
LOG_LEVEL="info"
ENABLE_DEBUG_LOGS="true"
ENABLE_ACCESS_LOGS="true"
ENABLE_ERROR_LOGS="true"
ENABLE_SECURITY_LOGS="true"
ENABLE_PERFORMANCE_LOGS="true"
ENABLE_AUDIT_LOGS="true"

# Log formatting
LOG_FORMAT="json"
ENABLE_STRUCTURED_LOGGING="true"
ENABLE_LOG_CORRELATION="true"
LOG_TIMESTAMP_FORMAT="ISO8601"

# Log rotation and retention
LOG_MAX_SIZE="500M"
LOG_RETENTION_DAYS="30"
LOG_COMPRESS="true"
LOG_ROTATION_FREQUENCY="daily"
ENABLE_REMOTE_LOGGING="false"

# Log aggregation
ENABLE_CENTRALIZED_LOGGING="false"
LOG_AGGREGATION_ENDPOINT=""
ENABLE_LOG_SHIPPING="false"

# ============================================================================
# Backup & Recovery (Enterprise)
# ============================================================================

# Backup configuration
ENABLE_AUTOMATIC_BACKUP="true"
BACKUP_FREQUENCY="daily"
BACKUP_RETENTION_DAYS="30"
BACKUP_LOCATION="/var/backups/arcdeploy"
BACKUP_REMOTE_LOCATION=""

# Backup types
ENABLE_FULL_BACKUP="true"
ENABLE_INCREMENTAL_BACKUP="true"
ENABLE_DIFFERENTIAL_BACKUP="false"
ENABLE_SNAPSHOT_BACKUP="false"

# Backup encryption
BACKUP_ENCRYPTION_KEY=""
BACKUP_COMPRESSION="gzip"
BACKUP_VERIFICATION="true"

# Recovery settings
ENABLE_AUTO_RECOVERY="true"
ENABLE_ROLLBACK_ON_FAILURE="true"
RECOVERY_TIMEOUT="1800"
MAX_RECOVERY_ATTEMPTS="3"

# ============================================================================
# Development & Testing
# ============================================================================

# Development features
ENABLE_DEVELOPMENT_MODE="false"
ENABLE_HOT_RELOAD="false"
ENABLE_SOURCE_MAPS="false"
ENABLE_PROFILING="false"
ENABLE_DEBUG_ENDPOINTS="false"

# Testing configuration
ENABLE_UNIT_TESTS="true"
ENABLE_INTEGRATION_TESTS="true"
ENABLE_PERFORMANCE_TESTS="true"
ENABLE_SECURITY_TESTS="true"
ENABLE_E2E_TESTS="false"

# Test data management
TEST_DATA_RETENTION="7"
ENABLE_TEST_ISOLATION="true"
TEST_PARALLEL_EXECUTION="true"
MAX_TEST_WORKERS="4"

# ============================================================================
# Template System
# ============================================================================

# Template engine
TEMPLATE_ENGINE="envsubst"
ENABLE_CUSTOM_TEMPLATES="true"
TEMPLATE_VALIDATION="true"
TEMPLATE_CACHE="true"

# Template locations
TEMPLATE_DIR="/opt/arcdeploy/templates"
CUSTOM_TEMPLATE_DIR="/etc/arcdeploy/templates"
GENERATED_CONFIG_DIR="/var/lib/arcdeploy/generated"

# Template processing
ENABLE_TEMPLATE_PREPROCESSING="true"
ENABLE_TEMPLATE_INCLUDES="true"
ENABLE_CONDITIONAL_BLOCKS="true"
TEMPLATE_MAX_RECURSION="10"

# ============================================================================
# API & Integration
# ============================================================================

# API configuration
ENABLE_REST_API="false"
API_PORT="8090"
API_AUTH_METHOD="token"
API_RATE_LIMITING="true"
API_MAX_REQUESTS_PER_MINUTE="100"

# Webhooks
ENABLE_WEBHOOKS="false"
WEBHOOK_TIMEOUT="30"
WEBHOOK_RETRY_ATTEMPTS="3"
WEBHOOK_SECURITY="hmac-sha256"

# External integrations
ENABLE_GITHUB_INTEGRATION="false"
ENABLE_GITLAB_INTEGRATION="false"
ENABLE_JENKINS_INTEGRATION="false"
ENABLE_TERRAFORM_INTEGRATION="false"

# ============================================================================
# Scalability & High Availability
# ============================================================================

# Load balancing
ENABLE_LOAD_BALANCING="false"
LOAD_BALANCER_TYPE="nginx"
LOAD_BALANCER_ALGORITHM="round_robin"
HEALTH_CHECK_PATH="/health"

# Clustering
ENABLE_CLUSTERING="false"
CLUSTER_SIZE="3"
CLUSTER_AUTO_SCALE="false"
CLUSTER_MIN_NODES="1"
CLUSTER_MAX_NODES="10"

# Database clustering
ENABLE_DB_CLUSTERING="false"
DB_CLUSTER_TYPE="master-slave"
DB_REPLICATION_LAG_THRESHOLD="1000"

# ============================================================================
# Cost Optimization
# ============================================================================

# Resource optimization
ENABLE_AUTO_SCALING="false"
ENABLE_RESOURCE_MONITORING="true"
ENABLE_COST_TRACKING="false"
ENABLE_IDLE_DETECTION="true"

# Scheduling
ENABLE_SCHEDULED_OPERATIONS="true"
MAINTENANCE_WINDOW="02:00-04:00"
AUTO_SHUTDOWN_ENABLED="false"
AUTO_STARTUP_ENABLED="false"

# ============================================================================
# Compliance & Governance
# ============================================================================

# Compliance frameworks
ENABLE_SOC2_COMPLIANCE="false"
ENABLE_GDPR_COMPLIANCE="false"
ENABLE_HIPAA_COMPLIANCE="false"
ENABLE_PCI_DSS_COMPLIANCE="false"

# Governance
ENABLE_POLICY_ENFORCEMENT="false"
ENABLE_RESOURCE_TAGGING="true"
ENABLE_CHANGE_TRACKING="true"
ENABLE_APPROVAL_WORKFLOWS="false"

# ============================================================================
# Advanced Validation Rules
# ============================================================================

# Required fields for advanced profile
REQUIRED_VARS="USER_NAME SSH_PORT BLOCKLET_HTTP_PORT BLOCKLET_BASE_DIR NODE_HOME"

# Optional fields with defaults
OPTIONAL_VARS="SSH_PUBLIC_KEY DOMAIN_NAME EMAIL_ADDRESS CLOUD_PROVIDER REGION INSTANCE_TYPE"

# Validation rules
VALIDATE_SSH_PORT_RANGE="1024-65535"
VALIDATE_USER_NAME_PATTERN="^[a-z][a-z0-9-]*$"
VALIDATE_PORT_AVAILABILITY="true"
VALIDATE_DNS_RESOLUTION="true"
VALIDATE_SSL_CERTIFICATES="true"
VALIDATE_CLOUD_CREDENTIALS="false"

# Performance validation
VALIDATE_MEMORY_REQUIREMENTS="true"
VALIDATE_DISK_SPACE="true"
VALIDATE_NETWORK_BANDWIDTH="false"
MIN_MEMORY_GB="4"
MIN_DISK_GB="20"
MIN_BANDWIDTH_MBPS="100"

# ============================================================================
# Error Handling (Advanced)
# ============================================================================

# Error handling behavior
FAIL_ON_WARNINGS="false"
CONTINUE_ON_NON_CRITICAL_ERRORS="true"
AUTO_RETRY_FAILED_COMMANDS="true"
MAX_RETRY_ATTEMPTS="5"
RETRY_BACKOFF_MULTIPLIER="2"

# Recovery options
ENABLE_AUTO_RECOVERY="true"
ENABLE_ROLLBACK_ON_FAILURE="true"
ENABLE_MANUAL_RECOVERY_PROMPTS="false"
ENABLE_RECOVERY_HOOKS="true"

# Error notification
ENABLE_ERROR_NOTIFICATIONS="false"
ERROR_NOTIFICATION_EMAIL=""
ERROR_NOTIFICATION_SLACK=""
ERROR_WEBHOOK_URL=""

# ============================================================================
# Output Settings (Advanced)
# ============================================================================

# Output formatting
OUTPUT_FORMAT="detailed"
ENABLE_COLOR_OUTPUT="true"
ENABLE_PROGRESS_BARS="true"
ENABLE_VERBOSE_OUTPUT="true"
ENABLE_JSON_OUTPUT="false"

# Status reporting
SHOW_TIMESTAMPS="true"
SHOW_STEP_NUMBERS="true"
SHOW_ESTIMATED_TIME="true"
SHOW_RESOURCE_USAGE="true"
SHOW_PERFORMANCE_METRICS="true"

# Interactive features
ENABLE_INTERACTIVE_MODE="false"
ENABLE_CONFIRMATION_PROMPTS="false"
ENABLE_PROGRESS_NOTIFICATIONS="false"

# ============================================================================
# Profile Notes
# ============================================================================

# This advanced profile is designed for:
# - Enterprise deployments with complex requirements
# - Multi-cloud environments requiring flexibility
# - Development environments needing comprehensive tooling
# - Production environments requiring high availability
# - Organizations with specific compliance requirements
#
# Features include:
# - Comprehensive monitoring and alerting
# - Advanced security configurations
# - Multi-cloud provider support
# - Extensive testing framework
# - Performance optimization
# - Backup and recovery capabilities
# - API and integration support
# - Scalability features
#
# Note: Not all features are enabled by default
# Review and customize settings based on your specific requirements